<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<title data-react-helmet="true">Autoheight WebView | webshell</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Autoheight WebView | webshell"><meta data-react-helmet="true" name="description" content="Craft -based components which heights automatically and dynamically adapts to their page"><meta data-react-helmet="true" property="og:description" content="Craft -based components which heights automatically and dynamically adapts to their page"><meta data-react-helmet="true" property="og:url" content="https://formidable-webview.github.io/webshell/docs/autoheight"><link data-react-helmet="true" rel="shortcut icon" href="/webshell/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://formidable-webview.github.io/webshell/docs/autoheight"><link rel="stylesheet" href="/webshell/styles.3551e5c2.css">
<link rel="preload" href="/webshell/styles.64a8f201.js" as="script">
<link rel="preload" href="/webshell/runtime~main.5cf00a6a.js" as="script">
<link rel="preload" href="/webshell/main.84c15b70.js" as="script">
<link rel="preload" href="/webshell/1.7d7f2326.js" as="script">
<link rel="preload" href="/webshell/2.2279a79b.js" as="script">
<link rel="preload" href="/webshell/58.9e9e45dc.js" as="script">
<link rel="preload" href="/webshell/59.7b7d1fff.js" as="script">
<link rel="preload" href="/webshell/935f2afb.e0932a21.js" as="script">
<link rel="preload" href="/webshell/17896441.7b81dcd5.js" as="script">
<link rel="preload" href="/webshell/57.08e8e1ad.js" as="script">
<link rel="preload" href="/webshell/903270da.961f83c3.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/webshell/"><img class="navbar__logo" src="/webshell/img/logo.svg" alt="Formidable WebView Logo"><strong class="navbar__title">webshell</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/webshell/docs/">Docs</a><a class="navbar__item navbar__link" href="/webshell/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/formidable-webview/webshell" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2rYK"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_1W7I">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_1W7I">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/webshell/"><img class="navbar__logo" src="/webshell/img/logo.svg" alt="Formidable WebView Logo"><strong class="navbar__title">webshell</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/webshell/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/webshell/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/formidable-webview/webshell" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_3G3U"><div class="docSidebarContainer_2HHq" role="complementary"><div class="sidebar_1xH1"><div class="menu menu--responsive menu_3E8f"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1XLy" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Webshell</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/webshell/docs/autoheight">Autoheight WebView</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/webshell/docs/implementing-features">Implementing Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/webshell/docs/tooling">Tooling</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/webshell/docs/features">Features Reference</a></li><li class="menu__list-item"><a class="menu__link" href="/webshell/docs/faq">FAQ</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api">Globals</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Classes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/classes/feature">Feature</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/classes/featurebuilder">FeatureBuilder</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Interfaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/autoheightparams">AutoheightParams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/autoheightstate">AutoheightState</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/cssbox">CSSBox</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/cssboxdimensionscomputedstyle">CSSBoxDimensionsComputedStyle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/domrect">DOMRect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/domrectsize">DOMRectSize</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/elementcssboxdimensions">ElementCSSBoxDimensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/featurebuilderconfig">FeatureBuilderConfig</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/featureconstructor">FeatureConstructor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/forceelementsizeoptions">ForceElementSizeOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/forceresponsiveviewportoptions">ForceResponsiveViewportOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/htmldimensions">HTMLDimensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/handleelementcssboxdimensionsoptions">HandleElementCSSBoxDimensionsOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/handlehtmldimensionsoptions">HandleHTMLDimensionsOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/handlehashchangeoptions">HandleHashChangeOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/hashchangeevent">HashChangeEvent</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/linkpressoptions">LinkPressOptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/linkpresstarget">LinkPressTarget</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/minimalwebviewprops">MinimalWebViewProps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/visualviewportdimensions">VisualViewportDimensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/webjscontext">WebjsContext</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/webshell/docs/api/interfaces/webshellinvariantprops">WebshellInvariantProps</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_23gr"><div class="container padding-vert--lg docItemWrapper_3l-Z"><div class="row"><div class="col docItemCol_F4HC"><div class="docItemContainer_2MrJ"><article><header><h1 class="docTitle_2KCJ">Autoheight WebView</h1></header><div class="markdown"><p>Craft <a class="api-ref api-symbol class" href="https://github.com/react-native-community/react-native-webview">WebView</a>-based components which heights automatically and dynamically adapts to their page
content heights, anytime the <strong><abbr title="Document Object Model"><a class="term" title="Document Object Model" href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction">DOM</a></abbr></strong> changes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="highlights"></a>Highlights<a aria-hidden="true" tabindex="-1" class="hash-link" href="#highlights" title="Direct link to heading">#</a></h2><div class="margin-vert--lg" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap"><div style="margin-right:20px;flex-basis:400px"><div class="card api-box shadow--lt" style="text-align:center"><div class="card__header api-box__title">~ API Reference ~</div><a class="api-ref api-symbol function" href="/webshell/docs/api/index#useautoheight">useAutoheight</a></div><ul><li><p>The <strong>width</strong> of the <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> will grow to the
available horizontal space and won&#x27;t need to be specified. You can
override this behavior by setting explicit <code>width</code> as a
parameter attribute of <a class="api-ref api-symbol function" href="/webshell/docs/api/index#useautoheight">useAutoheight</a> hook.</p></li><li><p>The <strong>height</strong> of the <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> will dynamically adapts to the <strong>content height</strong>, which has
been constrained by the <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> <strong>width</strong> as we have just mentioned! It
means that anytime the content changes or the <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> width changes,
such as in screen rotations, the <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> height will get updated.</p><p>Look at the screen and notice in the top console how <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> height closely follows <strong>content</strong> height updates.</p></li><li><p>This hook will rely on <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#handlehtmldimensionsfeature">HandleHTMLDimensionsFeature</a> to use the best API
available in the browser
<strong>and dynamically adapt <strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> to content size</strong>. In
order of preference,
<a href="https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver" target="_blank" rel="noopener noreferrer">ResizeObserver</a>,
<a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver" target="_blank" rel="noopener noreferrer">MutationObserver</a>
and finally, polling on a regular interval.</p></li></ul></div><div class="marvel-device nexus5" role="figure"><div class="top-bar"></div><div class="sleep"></div><div class="volume"></div><div class="camera"></div><div class="screen"><video loop="" autoplay="" style="width:320px;height:568px"><source src="/webshell/img/autoheight-screencast.mp4" type="video/mp4"></video></div><div style="position:absolute;bottom:50px;left:15px;right:15px;height:42px;display:flex;justify-content:center;align-items:center;background-color:black;z-index:100"><a><i style="font-size:30px;color:white;display:block" class="material-icons" role="button">play_arrow</i></a></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can interchangeably replace &quot;<strong><span><a class="term" href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">viewport</a></span></strong> size&quot; with &quot;<a class="api-ref api-symbol class" href="https://github.com/react-native-community/react-native-webview">WebView</a>
size&quot; in the above description, if that makes more sense to you.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="basic-example"></a>Basic Example<a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-example" title="Direct link to heading">#</a></h2><p>As previously stated, <a class="api-ref api-symbol function" href="/webshell/docs/api/index#useautoheight">useAutoheight</a>
requires <em>a minima</em> injection of a <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#handlehtmldimensionsfeature">HandleHTMLDimensionsFeature</a> in the shell to fetch content dimensions:</p><div class="mdxCodeBlock__-node_modules-@docusaurus-theme-classic-lib-theme-MDXComponents-"><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3pnN tabs__item--active" style="outline:none">Typescript</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3pnN" style="outline:none">JavaScript</li></ul><div role="tabpanel" class="margin-vert--md"><div><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_1-z1">MinimalAutoheightWebView.tsx</div><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy undefined">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_196X codeBlockWithTitle_1kb2"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="caveats-and-their-workarounds"></a>Caveats and their Workarounds<a aria-hidden="true" tabindex="-1" class="hash-link" href="#caveats-and-their-workarounds" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="mobile-virtual-viewport"></a>Mobile Virtual Viewport<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mobile-virtual-viewport" title="Direct link to heading">#</a></h3><p>In some circumstances, the mobile browser might use a virtual
viewport much larger then the available width in the <a class="api-ref api-symbol class" href="https://github.com/react-native-community/react-native-webview">WebView</a>, often
around 980px for websites which have been built for desktop. For
this autoheight component to be reliable, you must ensure that the
content has a <a href="https://www.w3schools.com/css/css_rwd_viewport.asp" target="_blank" rel="noopener noreferrer">meta viewport element</a>
in the header.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>solution</h5></div><div class="admonition-content"><p>This can be enforced by setting responsive layout with <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#forceresponsiveviewportfeature">ForceResponsiveViewportFeature</a>.</p><div class="mdxCodeBlock_24uS"><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_196X"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token maybe-class-name">Webshell</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">makeWebshell</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token maybe-class-name">WebView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">HandleHTMLDimensionsFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ForceResponsiveViewportFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> maxScale</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div></div></div><p>However, the result might be ugly and overflow on the horizontal axis if the page is not responsive (optimized for mobile).
Always make sure the content is optimized for mobile, <a href="https://developers.google.com/search/mobile-sites/mobile-seo/responsive-design" target="_blank" rel="noopener noreferrer">read more about this here</a>.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="cyclic-size-constraints-âˆž"></a>Cyclic Size Constraints âˆž<a aria-hidden="true" tabindex="-1" class="hash-link" href="#cyclic-size-constraints-âˆž" title="Direct link to heading">#</a></h3><div class="margin-vert--lg" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap"><div style="margin-right:20px;flex-basis:400px"><p>Because the <strong>viewport height</strong> now depends on <strong>content heigh</strong>, you must never have a <strong>body</strong> element
height depending on viewport height, such as:</p><div class="mdxCodeBlock_24uS"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_1-z1">evil.css</div><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy undefined">Copy</button><div tabindex="0" class="prism-code language-css codeBlock_196X codeBlockWithTitle_1kb2"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token selector" style="color:rgb(255, 121, 198)">body</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token unit">vh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div></div></div><div class="margin-bottom--md" style="text-align:center;font-style:italic">or</div><div class="mdxCodeBlock_24uS"><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_1-z1">evil.css</div><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy undefined">Copy</button><div tabindex="0" class="prism-code language-css codeBlock_196X codeBlockWithTitle_1kb2"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token selector" style="color:rgb(255, 121, 198)">body</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">height</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token unit">%</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></div></div></div></div></div><p>That is an evil cyclic dependency ready to cast an infinite loop!
Wikipedia website has such styles. Watch the console on top of screen and
notice how the shell is caught in an infinite loop shrinking the height
inexorably.</p></div><div class="marvel-device nexus5" role="figure"><div class="top-bar"></div><div class="sleep"></div><div class="volume"></div><div class="camera"></div><div class="screen"><video loop="" autoplay="" style="width:320px;height:568px"><source src="/webshell/img/autoheight-regression-screencast.mp4" type="video/mp4"></video></div><div style="position:absolute;bottom:50px;left:15px;right:15px;height:42px;display:flex;justify-content:center;align-items:center;background-color:black;z-index:100"><a><i style="font-size:30px;color:white;display:block" class="material-icons" role="button">play_arrow</i></a></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>solution</h5></div><div class="admonition-content"><p>Body width and height can be forced to
<strong>auto</strong> with <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#forceelementsizefeature">ForceElementSizeFeature</a>.</p><div class="mdxCodeBlock_24uS"><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_196X"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token maybe-class-name">Webshell</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">makeWebshell</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token maybe-class-name">WebView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">HandleHTMLDimensionsFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ForceElementSizeFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">    target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;body&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">    heightValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;auto&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">    widthValue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;auto&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="robust-example"></a>Robust Example<a aria-hidden="true" tabindex="-1" class="hash-link" href="#robust-example" title="Direct link to heading">#</a></h2><p>In this example, we use the two tips listed in above Caveats section to provide a much resilient implementation.</p><div class="mdxCodeBlock__-node_modules-@docusaurus-theme-classic-lib-theme-MDXComponents-"><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3pnN tabs__item--active" style="outline:none">Typescript</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3pnN" style="outline:none">JavaScript</li></ul><div role="tabpanel" class="margin-vert--md"><div><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_1-z1">ResilientAutoheightWebView.tsx</div><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy undefined">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_196X codeBlockWithTitle_1kb2"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="integration-with-scrollview"></a>Integration with ScrollView<a aria-hidden="true" tabindex="-1" class="hash-link" href="#integration-with-scrollview" title="Direct link to heading">#</a></h2><p>More often than not, an autoheight feature is needed to embed the <a class="api-ref api-symbol class" href="https://github.com/react-native-community/react-native-webview">WebView</a> along with
content of unpredictable length, and a <a class="api-ref api-symbol class" href="https://reactnative.dev/docs/scrollview">ScrollView</a> works just fine.
This section summarize best practices and tricks for a perfect integration.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="recommended-scrollview-props-values"></a>Recommended ScrollView Props Values<a aria-hidden="true" tabindex="-1" class="hash-link" href="#recommended-scrollview-props-values" title="Direct link to heading">#</a></h3><table><thead><tr><th align="left">Prop</th><th align="left">Value</th><th align="left">Rationale</th></tr></thead><tbody><tr><td align="left"><code>pinchGestureEnabled</code></td><td align="left"><code>false</code></td><td align="left">Enabling pinch (the default) will conflict with the pinch-to-zoom feature provided by <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#forceresponsiveviewportfeature">ForceResponsiveViewportFeature</a> <code>maxScale</code> option. When <code>maxScale</code> is above <code>1</code>, it will allow for pinch to zoom gestures up to the provided zoom level.</td></tr><tr><td align="left"><code>horizontal</code></td><td align="left"><code>false</code></td><td align="left">When the web page is ill-designed (not-responsive), the content might overflows horizontally. We suggest to avoid nesting components providing scroll in the same direction, unless necessary.</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_1YVU" id="handling-hashchange-events"></a>Handling <code>hashchange</code> Events<a aria-hidden="true" tabindex="-1" class="hash-link" href="#handling-hashchange-events" title="Direct link to heading">#</a></h3><p>However, scroll to hash on link press, for example:</p><div class="mdxCodeBlock_24uS"><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy">Copy</button><div tabindex="0" class="prism-code language-html codeBlock_196X"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">a</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">href</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">#head</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">go to top</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">a</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></div></div></div></div></div><p>will not work, because the underlying <a class="api-ref api-symbol class" href="https://github.com/react-native-community/react-native-webview">WebView</a> will not have vertical scroll anymore.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>solution</h5></div><div class="admonition-content"><p>You can register a prop to listen to <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/hashchange_event" target="_blank" rel="noopener noreferrer">haschange</a> events with <a class="api-ref api-symbol variable" href="/webshell/docs/api/index#handlehashchangefeature">HandleHashChangeFeature</a>.</p><div class="mdxCodeBlock_24uS"><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy">Copy</button><div tabindex="0" class="prism-code language-jsx codeBlock_196X"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> Webshell </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">makeWebshell</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  WebView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">HandleHTMLDimensionsFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">HandleHashChangeFeature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> shouldResetHashOnEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></div></div></div></div></div></div></div><p>After that, you must implement the desired behavior, that is to scroll to the
desired DOM element when a hashchange event is fired, while accounting for the space
occupied by components above the shell, inside the <a class="api-ref api-symbol class" href="https://reactnative.dev/docs/scrollview">ScrollView</a>. Below is a complete
example:</p><div class="mdxCodeBlock__-node_modules-@docusaurus-theme-classic-lib-theme-MDXComponents-"><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3pnN tabs__item--active" style="outline:none">Typescript</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3pnN" style="outline:none">JavaScript</li></ul><div role="tabpanel" class="margin-vert--md"><div><div style="color:#F8F8F2;background-color:#282A36" class="codeBlockTitle_1-z1">AutoheightWebViewInScrollView.tsx</div><div class="codeBlockContent_142n"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1-Hy undefined">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_196X codeBlockWithTitle_1kb2"><div class="codeBlockLines_1yEX" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/autoheight.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/webshell/docs/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/webshell/docs/implementing-features"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Implementing Features Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3-RU"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#highlights" class="table-of-contents__link">Highlights</a></li><li><a href="#basic-example" class="table-of-contents__link">Basic Example</a></li><li><a href="#caveats-and-their-workarounds" class="table-of-contents__link">Caveats and their Workarounds</a><ul><li><a href="#mobile-virtual-viewport" class="table-of-contents__link">Mobile Virtual Viewport</a></li><li><a href="#cyclic-size-constraints-âˆž" class="table-of-contents__link">Cyclic Size Constraints âˆž</a></li></ul></li><li><a href="#robust-example" class="table-of-contents__link">Robust Example</a></li><li><a href="#integration-with-scrollview" class="table-of-contents__link">Integration with ScrollView</a><ul><li><a href="#recommended-scrollview-props-values" class="table-of-contents__link">Recommended ScrollView Props Values</a></li><li><a href="#handling-hashchange-events" class="table-of-contents__link">Handling <code>hashchange</code> Events</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Guides</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/webshell/docs/autoheight">Autoheight WebView</a></li><li class="footer__item"><a class="footer__link-item" href="/webshell/docs/implementing-features">Implementing Features</a></li><li class="footer__item"><a class="footer__link-item" href="/webshell/docs/tooling">Tooling</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/webshell" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discord.gg/XV3zt3d" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/webshell/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/formidable-webview/webshell" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Jules Sam. Randolph</div></div></div></footer></div>
<script src="/webshell/styles.64a8f201.js"></script>
<script src="/webshell/runtime~main.5cf00a6a.js"></script>
<script src="/webshell/main.84c15b70.js"></script>
<script src="/webshell/1.7d7f2326.js"></script>
<script src="/webshell/2.2279a79b.js"></script>
<script src="/webshell/58.9e9e45dc.js"></script>
<script src="/webshell/59.7b7d1fff.js"></script>
<script src="/webshell/935f2afb.e0932a21.js"></script>
<script src="/webshell/17896441.7b81dcd5.js"></script>
<script src="/webshell/57.08e8e1ad.js"></script>
<script src="/webshell/903270da.961f83c3.js"></script>
</body>
</html>